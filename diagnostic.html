<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico M√≥vil - Aromes De Dieu</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .diagnostic-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .error { color: #e74c3c; }
        .success { color: #27ae60; }
        .warning { color: #f39c12; }
        .info { color: #3498db; }
        .result-box {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #3498db;
            border-radius: 4px;
        }
        .test-button {
            background: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #2980b9;
        }
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="diagnostic-container">
        <h1>üîç Diagn√≥stico Completo - M√≥viles</h1>
        <p><strong>Usa esta p√°gina para detectar exactamente qu√© est√° fallando en tu sitio m√≥vil</strong></p>
        
        <button class="test-button" onclick="runFullDiagnostic()">üöÄ Ejecutar Diagn√≥stico Completo</button>
        <button class="test-button" onclick="testSpecificURL()">üéØ Probar URL Espec√≠fica</button>
        <button class="test-button" onclick="clearResults()">üßπ Limpiar Resultados</button>
        
        <div id="results"></div>
        
        <div class="result-box">
            <h3>üì± Instrucciones:</h3>
            <ol>
                <li><strong>Sube este archivo</strong> a la ra√≠z de tu proyecto como <code>diagnostic.html</code></li>
                <li><strong>Accede desde m√≥vil</strong> a: <code>tudominio.com/diagnostic.html</code></li>
                <li><strong>Ejecuta diagn√≥stico</strong> y comparte los resultados</li>
                <li><strong>Guarda los errores</strong> que aparezcan para analizarlos</li>
            </ol>
        </div>
    </div>

    <script>
        let diagnosticResults = [];

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                error: '#e74c3c',
                success: '#27ae60', 
                warning: '#f39c12',
                info: '#3498db'
            };
            
            diagnosticResults.push({
                time: timestamp,
                message: message,
                type: type
            });
            
            updateResults();
        }

        function updateResults() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = diagnosticResults.map(result => 
                `<div class="result-box" style="border-left-color: ${result.type === 'error' ? '#e74c3c' : result.type === 'success' ? '#27ae60' : result.type === 'warning' ? '#f39c12' : '#3498db'}">
                    <strong>[${result.time}]</strong> <span class="${result.type}">${result.message}</span>
                </div>`
            ).join('');
        }

        function clearResults() {
            diagnosticResults = [];
            updateResults();
        }

        async function runFullDiagnostic() {
            clearResults();
            log('üîç Iniciando diagn√≥stico completo...', 'info');
            
            // 1. Informaci√≥n b√°sica del dispositivo
            log('üì± INFORMACI√ìN DEL DISPOSITIVO:', 'info');
            log(`User Agent: ${navigator.userAgent}`, 'info');
            log(`Pantalla: ${screen.width}x${screen.height}`, 'info');
            log(`Viewport: ${window.innerWidth}x${window.innerHeight}`, 'info');
            log(`Ratio de p√≠xeles: ${window.devicePixelRatio}`, 'info');
            log(`Plataforma: ${navigator.platform}`, 'info');
            
            // 2. Verificar conexi√≥n
            if (navigator.connection) {
                log(`Tipo de conexi√≥n: ${navigator.connection.effectiveType}`, 'info');
                log(`Velocidad estimada: ${navigator.connection.downlink} Mbps`, 'info');
            }
            
            // 3. Probar carga de recursos principales
            log('üåê PROBANDO RECURSOS PRINCIPALES:', 'info');
            
            const testResources = [
                'index.html',
                'css/style.css?v=4.0',
                'css/navbar.css?v=4.0', 
                'js/navbar.js?v=4.0',
                'html/navbar.html',
                'html/footer.html',
                'IMAGENES/POP.jpg'
            ];
            
            for (const resource of testResources) {
                await testResource(resource);
            }
            
            // 4. Probar fetch de componentes
            log('üîß PROBANDO COMPONENTES:', 'info');
            await testFetchComponent('html/navbar.html');
            await testFetchComponent('html/footer.html');
            
            // 5. Verificar JavaScript
            log('‚öôÔ∏è VERIFICANDO JAVASCRIPT:', 'info');
            testJavaScriptFeatures();
            
            // 6. Verificar localStorage
            testStorage();
            
            // 7. Verificar orientaci√≥n y touch
            testMobileFeatures();
            
            // 8. Monitorear errores
            setupErrorMonitoring();
            
            log('‚úÖ Diagn√≥stico completado', 'success');
        }

        async function testResource(url) {
            try {
                const response = await fetch(url, { 
                    method: 'HEAD',
                    cache: 'no-cache'
                });
                
                if (response.ok) {
                    log(`‚úÖ ${url} - OK (${response.status})`, 'success');
                } else {
                    log(`‚ùå ${url} - Error ${response.status}`, 'error');
                }
            } catch (error) {
                log(`‚ùå ${url} - Error: ${error.message}`, 'error');
            }
        }

        async function testFetchComponent(url) {
            try {
                const response = await fetch(url);
                if (response.ok) {
                    const content = await response.text();
                    log(`‚úÖ ${url} - Cargado (${content.length} chars)`, 'success');
                } else {
                    log(`‚ùå ${url} - Error ${response.status}`, 'error');
                }
            } catch (error) {
                log(`‚ùå ${url} - Error: ${error.message}`, 'error');
            }
        }

        function testJavaScriptFeatures() {
            try {
                // Probar fetch
                if (typeof fetch !== 'undefined') {
                    log('‚úÖ Fetch API disponible', 'success');
                } else {
                    log('‚ùå Fetch API no disponible', 'error');
                }
                
                // Probar Promises
                if (typeof Promise !== 'undefined') {
                    log('‚úÖ Promises disponibles', 'success');
                } else {
                    log('‚ùå Promises no disponibles', 'error');
                }
                
                // Probar addEventListener
                if (typeof addEventListener !== 'undefined') {
                    log('‚úÖ Event Listeners disponibles', 'success');
                } else {
                    log('‚ùå Event Listeners no disponibles', 'error');
                }
                
            } catch (error) {
                log(`‚ùå Error probando JavaScript: ${error.message}`, 'error');
            }
        }

        function testStorage() {
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                log('‚úÖ localStorage funciona', 'success');
            } catch (error) {
                log(`‚ùå localStorage error: ${error.message}`, 'error');
            }
            
            try {
                sessionStorage.setItem('test', 'test');
                sessionStorage.removeItem('test');
                log('‚úÖ sessionStorage funciona', 'success');
            } catch (error) {
                log(`‚ùå sessionStorage error: ${error.message}`, 'error');
            }
        }

        function testMobileFeatures() {
            // Touch support
            if ('ontouchstart' in window) {
                log('‚úÖ Touch events soportados', 'success');
            } else {
                log('‚ö†Ô∏è Touch events no detectados', 'warning');
            }
            
            // Orientation
            if (screen.orientation) {
                log(`üì± Orientaci√≥n: ${screen.orientation.type}`, 'info');
            }
            
            // Media queries
            if (window.matchMedia) {
                const isMobile = window.matchMedia('(max-width: 768px)').matches;
                log(`üì± Es m√≥vil (CSS): ${isMobile}`, 'info');
            }
        }

        function setupErrorMonitoring() {
            window.addEventListener('error', (e) => {
                log(`üö® ERROR: ${e.message} en ${e.filename}:${e.lineno}`, 'error');
            });
            
            window.addEventListener('unhandledrejection', (e) => {
                log(`üö® PROMISE REJECTED: ${e.reason}`, 'error');
            });
            
            log('üëÅÔ∏è Monitoreo de errores activado', 'info');
        }

        async function testSpecificURL() {
            const url = prompt('Ingresa la URL a probar (ej: css/style.css?v=4.0):');
            if (url) {
                log(`üéØ Probando URL espec√≠fica: ${url}`, 'info');
                await testResource(url);
            }
        }

        // Auto-ejecutar algunas verificaciones b√°sicas al cargar
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ P√°gina de diagn√≥stico cargada', 'success');
            setupErrorMonitoring();
        });
    </script>
</body>
</html>
